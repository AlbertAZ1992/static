
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">

    <title>我的演说 - @演说.io</title>

    <meta name="keywords" content="演说，yanshuo, yanshuo.io, 演说.io, 空中演说, 展示文稿, HTML 展示文稿, Web 展示文稿" />
  	  <meta name="description" content="创作真正跨平台的 HTML5 展示文稿，让你的分享到达世界的任何一个角落" />

  		<meta name="apple-mobile-web-app-capable" content="yes">
  		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

  		<!-- Reveal base style -->
  		<link rel="stylesheet" href="https://yanshuo.io/assets/player/css/reveal.min.css">

  		<!-- Yanshuo.io seed style -->
  		<link rel="stylesheet" href="https://yanshuo.io/assets/player/atcss/at-block.min.css">
  		<link rel="stylesheet" href="https://yanshuo.io/assets/player/atcss/at-hljs-theme-bundler.min.css">
  		<link rel="stylesheet" href="https://yanshuo.io/assets/player/atcss/at-reveal-default-theme.min.css">

  		<!-- Source Sans Web Fonts -->
  		<link rel="stylesheet" href="https://yanshuo.io/assets/player/lib/font/source-sans-pro/source-sans-pro.css">

      <!-- Printing and PDF exports -->
      <script>
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = window.location.search.match( /print-pdf/gi ) ? 'https://yanshuo.io/assets/player//css/print/pdf.css' : '';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
      </script>

      <!--[if lt IE 9]>
  		<script src="lib/js/html5shiv.js"></script>
  		<![endif]-->

  		<!-- style for "critical path" -->
  		<style>
  	  </style>
  </head>
  <body>
    <!-- TODO: a lightweighted loading -->

    <!-- main slides -->
    <div id="YS" class="at-code-lh-12" style="width:100%;height:100%;" data-reveal-theme="white" data-highlight-theme="github" data-ys-title="我的演说" data-ys-user="liexiaodeng" data-ys-transition="slide" data-ys-backgroundTransition="slide" data-ys-transitionSpeed="default" data-ys-fv="2"><style>

  /*********************************************
   * THEME: white
   *********************************************/

  /*********************************************
   * Yanshuo Inject
   *********************************************/

   .hljs{
     
   }

  /*********************************************
   * GLOBAL STYLES
   *********************************************/

  body, .reveal, .reveal-preview {
  	background-color: #fff;
  }

  .reveal, .reveal-preview  {
    
    color: #222;
  }

  ::selection {
  	background: rgb(115, 164, 232);
  }

  /*********************************************
   * HEADERS
   *********************************************/

  .reveal h1, .reveal-preview h1,
  .reveal h2, .reveal-preview h2,
  .reveal h3, .reveal-preview h3,
  .reveal h4, .reveal-preview h4,
  .reveal h5, .reveal-preview h5,
  .reveal h6, .reveal-preview h6 {
    
  	color: #222;
  }


  /*********************************************
   * LINKS
   *********************************************/

  .reveal a, .reveal-preview a {
  	color: #2a76dd;
    text-decoration: undefined;
  }
  	.reveal a:hover, .reveal-preview a:hover {
  		color: rgb(101, 155, 230);
  	}


  /*********************************************
   * NAVIGATION CONTROLS
   *********************************************/

  .reveal .controls .navigate-left,
  .reveal .controls .navigate-left.enabled {
  	border-right-color: #2a76dd;
  }

  .reveal .controls .navigate-right,
  .reveal .controls .navigate-right.enabled {
  	border-left-color: #2a76dd;
  }

  .reveal .controls .navigate-up,
  .reveal .controls .navigate-up.enabled {
  	border-bottom-color: #2a76dd;
  }

  .reveal .controls .navigate-down,
  .reveal .controls .navigate-down.enabled {
  	border-top-color: #2a76dd;
  }

  .reveal .controls .navigate-left.enabled:hover {
  	border-right-color: rgb(101, 155, 230);
  }

  .reveal .controls .navigate-right.enabled:hover {
  	border-left-color: rgb(101, 155, 230);
  }

  .reveal .controls .navigate-up.enabled:hover {
  	border-bottom-color: rgb(101, 155, 230);
  }

  .reveal .controls .navigate-down.enabled:hover {
  	border-top-color: rgb(101, 155, 230);
  }

  /*********************************************
   * PROGRESS BAR
   *********************************************/

  .reveal .progress span {
  	background: #2a76dd;

</style><div class="reveal"><div class="slides"><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:79px;top:220px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500136687973" class="at-block-content"><h1><span style="color:#0062B1"><em>Lavas</em></span> <span style="font-size:48px">&amp;</span> <span style="color:#D33115">PWA</span></h1></article></div><div style="left:79px;top:360px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500136687974" class="at-block-content"><h2><span style="font-size:24px"><a href="http://yanshuo.io"><span style="color:#4D4D4D">Albert@July 2017</span></a></span></h2></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:79px;top:100px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500136687973" class="at-block-content"><h1><span style="font-size:72px">什么是 <span style="color:#D33115">PWA</span></span></h1></article></div><div style="left:79px;top:340px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500136687974" class="at-block-content"><ul><li>Progressive Web App</li><li>Native App : 臃肿，吃配置，下载成本...</li><li>Web App : 不稳定，响应迟钝，流失率高...</li></ul></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:79px;top:100px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500136687973" class="at-block-content"><h1><span style="font-size:72px">什么是 <span style="color:#D33115">PWA</span></span></h1></article></div><div style="left:79px;top:340px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500136687974" class="at-block-content"><ul><li>可靠 - Service Worker</li><li>体验 - App shell</li><li>粘性 - Web App Manifest</li></ul></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:79px;top:100px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500136687973" class="at-block-content"><h1><span style="color:#D33115">Service Worker</span></h1></article></div><div style="left:92.02810348036479px;top:269.64824120603015px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500136687974" class="at-block-content"><ul><li><p><span style="font-size:28px">独立的 worker 线程，独立的 worker context</span></p></li><li><p><span style="font-size:28px">一旦被 install 就永远存在，除非被 uninstall</span></p></li><li><p><span style="font-size:28px">需要的时候可以直接唤醒，不需要的时候自动睡眠</span></p></li><li><p><span style="font-size:28px">可编程拦截代理请求和返回，缓存文件</span></p></li><li><p><span style="font-size:28px">消息推送，不操作DOM</span></p></li></ul></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="slide-in slide-out"><div style="left:77.9771897445255px;top:199.83050870430054px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500136687973" class="at-block-content"><ul><li><p><span style="font-size:36px">Chrome&nbsp; V40 +</span></p></li><li><p><span style="font-size:36px">Firefox，Opera </span></p></li><li><p><span style="font-size:36px">Android Browser 4.x +</span></p></li><li><p><span style="font-size:36px">Android Chrome </span></p></li><li><p><span style="font-size:36px">iOS 。。</span></p></li></ul></article></div><div style="left:77.69718965196353px;top:34.85948259817606px;width:800px;" class="at-block at-block--pure"><article data-block-id="1653898850336" class="at-block-content"><h1><span style="font-size:36px">&nbsp;<span style="color:#D33115">Service Worker&nbsp;</span>浏览器兼容性</span></h1></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:77.69718965196353px;top:34.85948259817606px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500137939166" class="at-block-content"><h1><span style="font-size:36px">怎么使用 <span style="color:#D33115">Service Worker</span></span></h1></article></div><div style="left:100px;top:232px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500137939167" class="at-block-content"><ul><li>注册 Work Context</li><li>安装 &amp; 资源缓存</li><li>激活</li><li>定义请求</li><li>更新缓存策略</li></ul></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:55.54941373534338px;top:-5.527638190954789px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500137939166" class="at-block-content"><h1><span style="font-size:36px">注册 <span style="color:#D33115">Service Worker</span></span></h1></article></div><div style="left:79px;top:110px;width:800px;height:500px;" class="at-block at-block--pure"><article data-block-id="1500138514707" class="at-block-content MarkdownBlock"><pre class="hljs"><code class="lang-js"><span class="line width-2" start="1"><span class="hljs-keyword">if</span> (<span class="hljs-string">'serviceWorker'</span> <span class="hljs-keyword">in</span> navigator) {</span>
<span class="line width-2" start="2">    <span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">'load'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{</span>
<span class="line width-2" start="3">        navigator.serviceWorker.register(<span class="hljs-string">'/sw.js'</span>, {<span class="hljs-attr">scope</span>: <span class="hljs-string">'/'</span>})</span>
<span class="line width-2" start="4">            .then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">registration</span>) </span>{</span>
<span class="line width-2" start="5"></span>
<span class="line width-2" start="6">                <span class="hljs-comment">// 注册成功</span></span>
<span class="line width-2" start="7">                <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'ServiceWorker registration successful with scope: '</span>, registration.scope);</span>
<span class="line width-2" start="8">            })</span>
<span class="line width-2" start="9">            .catch(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err</span>) </span>{</span>
<span class="line width-2" start="10"></span>
<span class="line width-2" start="11">                <span class="hljs-comment">// 注册失败:(</span></span>
<span class="line width-2" start="12">                <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'ServiceWorker registration failed: '</span>, err);</span>
<span class="line width-2" start="13">            });</span>
<span class="line width-2" start="14">    });</span>
<span class="line width-2" start="15">}</span>
</code></pre>
</article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:55.54941373534338px;top:-7.527638190954789px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500138632255" class="at-block-content"><h1><span style="font-size:36px">安装 <span style="color:#D33115">Service Worker</span></span></h1></article></div><div style="left:79px;top:110px;width:800px;height:500px;" class="at-block at-block--pure"><article data-block-id="1500138712939" class="at-block-content MarkdownBlock"><pre class="hljs"><code class="lang-js"><span class="line width-2" start="1"><span class="hljs-keyword">this</span>.addEventListener(<span class="hljs-string">'install'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) </span>{</span>
<span class="line width-2" start="2">    event.waitUntil(</span>
<span class="line width-2" start="3">        caches.open(<span class="hljs-string">'my-test-cache-v1'</span>).then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">cache</span>) </span>{</span>
<span class="line width-2" start="4">            <span class="hljs-keyword">return</span> cache.addAll([</span>
<span class="line width-2" start="5">                <span class="hljs-string">'/'</span>,</span>
<span class="line width-2" start="6">                <span class="hljs-string">'/index.html'</span>,</span>
<span class="line width-2" start="7">                <span class="hljs-string">'/main.css'</span>,</span>
<span class="line width-2" start="8">                <span class="hljs-string">'/main.js'</span>,</span>
<span class="line width-2" start="9">                <span class="hljs-string">'/image.jpg'</span></span>
<span class="line width-2" start="10">            ]);</span>
<span class="line width-2" start="11">        })</span>
<span class="line width-2" start="12">    );</span>
<span class="line width-2" start="13">});</span>
</code></pre>
</article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:55.54941373534338px;top:-13.52763819095479px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500138743471" class="at-block-content"><h1><span style="font-size:36px">自定义&nbsp;<span style="color:#D33115">Service Worker </span>请求</span></h1></article></div><div style="left:79px;top:92px;width:800px;height:596.4079657546994px;" class="at-block at-block--pure"><article data-block-id="1500138754330" class="at-block-content MarkdownBlock"><pre class="hljs"><code class="lang-js"><span class="line width-2" start="1"><span class="hljs-keyword">this</span>.addEventListener(<span class="hljs-string">'fetch'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) </span>{</span>
<span class="line width-2" start="2">    event.respondWith(</span>
<span class="line width-2" start="3">        caches.match(event.request).then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">response</span>) </span>{</span>
<span class="line width-2" start="4">            <span class="hljs-comment">// 如果 Service Worker 有自己的返回，就直接返回，减少一次 http 请求</span></span>
<span class="line width-2" start="5">            <span class="hljs-keyword">if</span> (response) {</span>
<span class="line width-2" start="6">                <span class="hljs-keyword">return</span> response;</span>
<span class="line width-2" start="7">            }</span>
<span class="line width-2" start="8">            <span class="hljs-comment">// 如果 service worker 没有返回，那就得直接请求真实远程服务</span></span>
<span class="line width-2" start="9">            <span class="hljs-keyword">var</span> request = event.request.clone(); <span class="hljs-comment">// 把原始请求拷过来</span></span>
<span class="line width-2" start="10">            <span class="hljs-keyword">return</span> fetch(request).then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">httpRes</span>) </span>{</span>
<span class="line width-2" start="11">                <span class="hljs-keyword">if</span> (!httpRes || httpRes.status !== <span class="hljs-number">200</span>) {</span>
<span class="line width-2" start="12">                    <span class="hljs-keyword">return</span> httpRes;</span>
<span class="line width-2" start="13">                }</span>
<span class="line width-2" start="14">                <span class="hljs-comment">// 请求成功的话，将请求缓存起来。</span></span>
<span class="line width-2" start="15">                <span class="hljs-keyword">var</span> responseClone = httpRes.clone();</span>
<span class="line width-2" start="16">                caches.open(<span class="hljs-string">'my-test-cache-v1'</span>).then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">cache</span>) </span>{</span>
<span class="line width-2" start="17">                    cache.put(event.request, responseClone);</span>
<span class="line width-2" start="18">                });</span>
<span class="line width-2" start="19">                <span class="hljs-keyword">return</span> httpRes;</span>
<span class="line width-2" start="20">            });</span>
<span class="line width-2" start="21">        })</span>
<span class="line width-2" start="22">    );</span>
<span class="line width-2" start="23">});</span>
</code></pre>
</article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:79px;top:89px;width:800px;height:606.8304485389913px;" class="at-block at-block--pure"><article data-block-id="1500139401905" class="at-block-content MarkdownBlock"><pre class="hljs"><code class="lang-js"><span class="line width-2" start="1"><span class="hljs-comment">// 安装阶段跳过等待，直接进入 active</span></span>
<span class="line width-2" start="2">self.addEventListener(<span class="hljs-string">'install'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) </span>{</span>
<span class="line width-2" start="3">    event.waitUntil(self.skipWaiting());</span>
<span class="line width-2" start="4">});</span>
<span class="line width-2" start="5"></span>
<span class="line width-2" start="6">self.addEventListener(<span class="hljs-string">'activate'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">evnet</span>) </span>{</span>
<span class="line width-2" start="7">    event.waitUntil(</span>
<span class="line width-2" start="8">        <span class="hljs-built_in">Promise</span>.all([</span>
<span class="line width-2" start="9">            <span class="hljs-comment">// 更新客户端</span></span>
<span class="line width-2" start="10">            self.clients.claim(),</span>
<span class="line width-2" start="11">            <span class="hljs-comment">// 清理旧版本</span></span>
<span class="line width-2" start="12">            caches.keys().then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">cacheList</span>) </span>{</span>
<span class="line width-2" start="13">                <span class="hljs-keyword">return</span> <span class="hljs-built_in">Promise</span>.all(</span>
<span class="line width-2" start="14">                    cacheList.map(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">cacheName</span>) </span>{</span>
<span class="line width-2" start="15">                        <span class="hljs-keyword">if</span> (cacheName !== <span class="hljs-string">'my-test-cache-v1'</span>) {</span>
<span class="line width-2" start="16">                            <span class="hljs-keyword">return</span> caches.delete(cacheName);</span>
<span class="line width-2" start="17">                        }</span>
<span class="line width-2" start="18">                    })</span>
<span class="line width-2" start="19">                );</span>
<span class="line width-2" start="20">            })</span>
<span class="line width-2" start="21">        ])</span>
<span class="line width-2" start="22">    );</span>
<span class="line width-2" start="23">});</span>
</code></pre>
</article></div><div style="left:55.54941373534338px;top:-13.52763819095479px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500139483462" class="at-block-content"><h1><span style="font-size:36px">更新 <span style="color:#D33115">Service Worker</span> 缓存策略</span></h1></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:79px;top:100px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500137939166" class="at-block-content"><h1><span style="color:#D33115">App Shell</span> 模型</h1></article></div><div style="left:79px;top:340px;width:802.6056206960728px;height:auto000;" class="at-block at-block--pure"><article data-block-id="1500137939167" class="at-block-content"><ul><li>所有 UI 和基础架构都使用Service Worker本地缓存</li><li>随后的加载将仅检索新数据或发生更改的数据</li></ul></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:82.90843104410943px;top:-5.527638190954793px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500137939166" class="at-block-content"><h1><span style="font-size:48px"><span style="color:#D33115">App Shell</span> 模型</span></h1></article></div><div style="left:71.18313791178113px;top:149.08431044109437px;width:833.8730690489484px;height:503.9084310441094px;" class="at-block at-block--pure"><article data-block-id="1500140327981" class="at-block-content MarkdownBlock"><pre class="hljs"><code class="lang-js"><span class="line width-2" start="1"><span class="hljs-keyword">var</span> cacheName = <span class="hljs-string">'shell-content'</span>;</span>
<span class="line width-2" start="2"><span class="hljs-keyword">var</span> filesToCache = [</span>
<span class="line width-2" start="3">    <span class="hljs-string">'/css/styles.css'</span>,</span>
<span class="line width-2" start="4">    <span class="hljs-string">'/js/scripts.js'</span>,</span>
<span class="line width-2" start="5">    <span class="hljs-string">'/images/logo.svg'</span>,</span>
<span class="line width-2" start="6">    <span class="hljs-string">'/offline.html'</span>,</span>
<span class="line width-2" start="7">    <span class="hljs-string">'/'</span></span>
<span class="line width-2" start="8">];</span>
<span class="line width-2" start="9"></span>
<span class="line width-2" start="10">self.addEventListener(<span class="hljs-string">'install'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{</span>
<span class="line width-2" start="11">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'[ServiceWorker] Install'</span>);</span>
<span class="line width-2" start="12">    e.waitUntil(</span>
<span class="line width-2" start="13">        caches.open(cacheName).then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">cache</span>) </span>{</span>
<span class="line width-2" start="14">            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'[ServiceWorker] Caching app shell'</span>);</span>
<span class="line width-2" start="15">            <span class="hljs-keyword">return</span> cache.addAll(filesToCache);</span>
<span class="line width-2" start="16">        })</span>
<span class="line width-2" start="17">    );</span>
<span class="line width-2" start="18">});</span>
</code></pre>
</article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:79px;top:100px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500137939166" class="at-block-content"><h1><span style="color:#D33115">manifest.json</span></h1></article></div><div style="left:79px;top:340px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500137939167" class="at-block-content"><ul><li>添加到主屏</li><li>原生体验</li></ul></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:81.60562069607296px;top:-13.344500279173662px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500137939166" class="at-block-content"><h1><span style="color:#D33115"><span style="font-size:48px">manifest.json</span></span></h1></article></div><div style="left:79px;top:267.64005211241397px;width:800px;height:342.35994788758603px;" class="at-block at-block--pure"><article data-block-id="1500140647995" class="at-block-content MarkdownBlock"><pre class="hljs"><code class="lang-js"><span class="line width-2" start="1">{</span>
<span class="line width-2" start="2">    <span class="hljs-string">"name"</span>: <span class="hljs-string">"这是一个完整名称"</span>,</span>
<span class="line width-2" start="3">    <span class="hljs-string">"icons"</span>: [</span>
<span class="line width-2" start="4">        {</span>
<span class="line width-2" start="5">            <span class="hljs-string">"url"</span>: <span class="hljs-string">"path-to-images/logo-144x144.png"</span>,</span>
<span class="line width-2" start="6">            <span class="hljs-string">"type"</span>: <span class="hljs-string">"image/png"</span>,</span>
<span class="line width-2" start="7">            <span class="hljs-string">"sizes"</span>: <span class="hljs-string">"144x144"</span></span>
<span class="line width-2" start="8">        }</span>
<span class="line width-2" start="9">    ],</span>
<span class="line width-2" start="10">    <span class="hljs-string">"background_color"</span>: <span class="hljs-string">"#2196f3"</span>,</span>
<span class="line width-2" start="11">    <span class="hljs-string">"display"</span>: <span class="hljs-string">"standalone"</span></span>
<span class="line width-2" start="12">}</span>
</code></pre>
</article></div><div style="left:75.09156895589057px;top:195.98548297040762px;width:800px;height:167.78336125069788px;" class="at-block at-block--pure"><article data-block-id="1500140708165" class="at-block-content MarkdownBlock"><pre class="hljs"><code class="lang-html"><span class="line width-1" start="1"><span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"manifest"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"path-to-manifest/manifest.json"</span>&gt;</span></span>
</code></pre>
</article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:81.60562069607296px;top:-13.344500279173662px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500140874718" class="at-block-content"><h1><span style="color:#D33115"><span style="font-size:48px">manifest.json</span></span></h1></article></div><div style="width:848.8888888888889px;height:320.09208103130754px;left:58.8235294117647px;top:257.96121763622574px;" class="at-block at-block--pure"><article data-block-id="1500198122618" class="at-block-content"><img src=http://ostfze5xf.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-07-16%20%E4%B8%8B%E5%8D%885.39.56.png /></article></div><div style="left:77.69281045751634px;top:147.90849673202615px;width:800px;height:84.31372549019608px;" class="at-block at-block--pure"><article data-block-id="1500198144861" class="at-block-content MarkdownBlock"><pre class="hljs"><code><span class="line width-1" start="1"><span class="hljs-built_in">display</span>: {<span class="hljs-keyword">string</span>}</span>
</code></pre>
</article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:77.69718965196353px;top:-22.79508654383028px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500137939166" class="at-block-content"><h1><span style="font-size:36px">消息通知</span></h1></article></div><div style="left:79px;top:110px;width:800px;height:500px;" class="at-block at-block--pure"><article data-block-id="1500172647374" class="at-block-content MarkdownBlock"><ul>
<li>使用 <code>showNotification()</code> 弹出通知<pre class="hljs"><code class="lang-js"><span class="line width-1" start="1"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">execute</span>(<span class="hljs-params"></span>) </span>{</span>
<span class="line width-1" start="2">  registerServiceWorker()</span>
<span class="line width-1" start="3">    .then(<span class="hljs-function"><span class="hljs-params">registration</span> =&gt;</span> {</span>
<span class="line width-1" start="4">      registration</span>
<span class="line width-1" start="5">         .showNotification(<span class="hljs-string">'Hello World!'</span>, options);</span>
<span class="line width-1" start="6">    });</span>
<span class="line width-1" start="7">}</span>
</code></pre>
</li>
</ul>
</article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:82.90843104410943px;top:73.5213102549786px;width:800px;height:597.710776102736px;" class="at-block at-block--pure"><article data-block-id="1500172762385" class="at-block-content MarkdownBlock"><pre class="hljs"><code><span class="line width-2" start="1">{</span>
<span class="line width-2" start="2">    <span class="hljs-comment">// 视觉相关</span></span>
<span class="line width-2" start="3">    <span class="hljs-string">"body"</span>: <span class="hljs-string">"&lt;String&gt;"</span>,</span>
<span class="line width-2" start="4">    <span class="hljs-string">"icon"</span>: <span class="hljs-string">"&lt;URL String&gt;"</span>,</span>
<span class="line width-2" start="5">    <span class="hljs-string">"image"</span>: <span class="hljs-string">"&lt;URL String&gt;"</span>,</span>
<span class="line width-2" start="6">    <span class="hljs-string">"badge"</span>: <span class="hljs-string">"&lt;URL String&gt;"</span>,</span>
<span class="line width-2" start="7">    <span class="hljs-string">"vibrate"</span>: <span class="hljs-string">"&lt;Array of Integers&gt;"</span>,</span>
<span class="line width-2" start="8">    <span class="hljs-string">"sound"</span>: <span class="hljs-string">"&lt;URL String&gt;"</span>,</span>
<span class="line width-2" start="9">    <span class="hljs-string">"dir"</span>: <span class="hljs-string">"&lt;String of 'auto' | 'ltr' | 'rtl'&gt;"</span>,</span>
<span class="line width-2" start="10"></span>
<span class="line width-2" start="11">    <span class="hljs-comment">// 行为相关</span></span>
<span class="line width-2" start="12">    <span class="hljs-string">"tag"</span>: <span class="hljs-string">"&lt;String&gt;"</span>,</span>
<span class="line width-2" start="13">    <span class="hljs-string">"data"</span>: <span class="hljs-string">"&lt;Anything&gt;"</span>,</span>
<span class="line width-2" start="14">    <span class="hljs-string">"requireInteraction"</span>: <span class="hljs-string">"&lt;boolean&gt;"</span>,</span>
<span class="line width-2" start="15">    <span class="hljs-string">"renotify"</span>: <span class="hljs-string">"&lt;Boolean&gt;"</span>,</span>
<span class="line width-2" start="16">    <span class="hljs-string">"silent"</span>: <span class="hljs-string">"&lt;Boolean&gt;"</span>,</span>
<span class="line width-2" start="17"></span>
<span class="line width-2" start="18">    <span class="hljs-comment">// 视觉行为均会影响</span></span>
<span class="line width-2" start="19">    <span class="hljs-string">"actions"</span>: <span class="hljs-string">"&lt;Array of Strings&gt;"</span>,</span>
<span class="line width-2" start="20"></span>
<span class="line width-2" start="21">    <span class="hljs-comment">// 定时发送时间戳</span></span>
<span class="line width-2" start="22">    <span class="hljs-string">"timestamp"</span>: <span class="hljs-string">"&lt;Long&gt;"</span></span>
<span class="line width-2" start="23">}</span>
</code></pre>
</article></div><div style="left:77.69718965196353px;top:-22.79508654383028px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500172773599" class="at-block-content"><h1><span style="font-size:36px">消息通知</span></h1></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:77.69718965196353px;top:-22.79508654383028px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500173910026" class="at-block-content"><h1><span style="font-size:36px">消息通知</span></h1></article></div><div style="left:79px;top:110px;width:800px;height:500px;" class="at-block at-block--pure"><article data-block-id="1500173920384" class="at-block-content MarkdownBlock"><ul>
<li>event.notificationclick  - 捕获用户点击</li>
<li>event.notification.data  - 获取消息数据</li>
<li>clients.openWindow() </li>
<li>clients.focus()</li>
<li>clients.matchAll()</li>
<li>clients.postMessage()</li>
</ul>
</article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:79px;top:100px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500137939166" class="at-block-content"><h1><em><span style="color:#0062B1">Lavas</span></em> 的意义</h1></article></div><div style="left:76.39000745712156px;top:287.800149142431px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500137939167" class="at-block-content"><ul><li>一个基于 Vue 的 PWA 完整解决方案<ul><li>Service worker</li><li>manifest.json</li><li>App Shell &amp; 离线 UX</li></ul></li><li>项目模板： basic 、AppShell、ssr 、mpa</li><li>开发者只需要关注业务</li></ul></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:77.69500372856078px;top:-16.14466815809098px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500137939166" class="at-block-content"><h1><span style="font-size:48px"><em><span style="color:#0062B1">Lavas</span></em> 脚手架</span></h1></article></div><div style="left:64.64504101416858px;top:89.1200596569724px;width:827.4049217002237px;height:389.07531692766594px;" class="at-block at-block--pure"><article data-block-id="1500176948894" class="at-block-content MarkdownBlock"><pre class="hljs"><code class="lang-shell"><span class="line width-1" start="1"><span class="hljs-meta">$</span><span class="bash"> npm install -g lavas</span></span>
<span class="line width-1" start="2"><span class="hljs-meta">$</span><span class="bash"> lavas init &amp; <span class="hljs-built_in">cd</span> pwa-demo</span></span>
<span class="line width-1" start="3"><span class="hljs-meta">$</span><span class="bash"> npm install</span></span>
<span class="line width-1" start="4"><span class="hljs-meta">$</span><span class="bash"> npm run dev</span></span>
</code></pre>
</article></div><div style="left:65.95003728560775px;top:231.3646532438479px;width:831.3199105145413px;height:500px;" class="at-block at-block--pure"><article data-block-id="1500177374477" class="at-block-content MarkdownBlock"><pre class="hljs"><code><span class="line width-2" start="1">pwa-project/ (项目根目录)</span>
<span class="line width-2" start="2">    | - build/ (Webpack 和 dev-server 相关调试和构建配置文件)</span>
<span class="line width-2" start="3">    | - config/ (通用模块配置)</span>
<span class="line width-2" start="4">    | - src/ (源代码)</span>
<span class="line width-2" start="5">        | - assets/ (依赖的静态资源)</span>
<span class="line width-2" start="6">        | - components/ (业务开发的 Vue Component)</span>
<span class="line width-2" start="7">        | - pages/ (具体业务开发的<span class="hljs-built_in"> Page </span>页面 Component)</span>
<span class="line width-2" start="8">        | - store/ (Vuex store)</span>
<span class="line width-2" start="9">        | - app.js (Vue 入口执行文件)</span>
<span class="line width-2" start="10">        | - App.vue (项目的根 Component)</span>
<span class="line width-2" start="11">        | - entry-client.js (前端渲染入口文件)</span>
<span class="line width-2" start="12">        | - entry-skeleton.js(skeleton 渲染入口)</span>
<span class="line width-2" start="13">        | - router.js (Vue-router 路由配置文件)</span>
<span class="line width-2" start="14">        | - sw-register.js (注册<span class="hljs-built_in"> service </span>worker 文件入口)</span>
<span class="line width-2" start="15">    | - static/ (不需要经过构建的一些静态资源)</span>
<span class="line width-2" start="16">    | - index.html</span>
<span class="line width-2" start="17">    | - package.json</span>
</code></pre>
</article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:76.39000745712156px;top:-5.704697986577182px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500182131465" class="at-block-content"><h1><span style="font-size:48px">用<span style="color:#0062B1"><em>Lavas</em></span> 开发</span></h1></article></div><div style="left:79px;top:110px;width:800px;height:500px;" class="at-block at-block--pure"><article data-block-id="1500182202655" class="at-block-content MarkdownBlock"><pre class="hljs"><code><span class="line width-1" start="1">$ npm <span class="hljs-keyword">run</span><span class="bash"> build</span></span>
</code></pre>
<ul>
<li>自动生成可见的文件<pre class="hljs"><code><span class="line width-1" start="1"><span class="hljs-regexp">/dist/</span>service-worker.js</span>
</code></pre>
</li>
</ul>
</article></div><div style="left:120.42394822006472px;top:344.2718446601942px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500192339302" class="at-block-content"><ul><li><span style="font-size:22px">支持离线缓存静态资源能力</span></li><li><span style="font-size:22px">动态网络请求</span></li><li><span style="font-size:22px">静态资源文件的缓存和更新</span></li><li><span style="font-size:22px">service-worker.js&nbsp;文件更新时，页面提示更新重载</span></li></ul></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:76.39000745712156px;top:-5.704697986577182px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500192480065" class="at-block-content"><h1><span style="font-size:48px">用<span style="color:#0062B1"><em>Lavas</em></span> 开发</span></h1></article></div><div style="left:73.8220064724919px;top:81.84466019417476px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500192484455" class="at-block-content"><ul><li><span style="font-size:24px">自定义配置</span></li></ul></article></div><div style="left:66.05501618122977px;top:124.18446601941747px;width:800px;height:727.831715210356px;" class="at-block at-block--pure"><article data-block-id="1500192562681" class="at-block-content MarkdownBlock"><pre class="hljs"><code class="lang-js"><span class="line width-2" start="1"><span class="hljs-comment">/* sw-precache.js中的配置 */</span></span>
<span class="line width-2" start="2">build: {</span>
<span class="line width-2" start="3">    <span class="hljs-attr">cacheId</span>: <span class="hljs-string">'my-vue-app'</span>,</span>
<span class="line width-2" start="4">    <span class="hljs-comment">// 生成的文件名称</span></span>
<span class="line width-2" start="5">    filename: <span class="hljs-string">'service-worker.js'</span>,</span>
<span class="line width-2" start="6">    <span class="hljs-comment">// 需缓存的文件配置, 可以逐项添加, 需动态缓存的放到runtimeCaching中处理</span></span>
<span class="line width-2" start="7">    staticFileGlobs: [</span>
<span class="line width-2" start="8">        <span class="hljs-comment">// 'dist/index.html',</span></span>
<span class="line width-2" start="9">        <span class="hljs-comment">// 'dist/static/**/**.*'</span></span>
<span class="line width-2" start="10">    ],</span>
<span class="line width-2" start="11">    <span class="hljs-comment">// 忽略的文件</span></span>
<span class="line width-2" start="12">    staticFileGlobsIgnorePatterns: [</span>
<span class="line width-2" start="13">        <span class="hljs-regexp">/\.map$/</span> <span class="hljs-comment">// map文件不需要缓存</span></span>
<span class="line width-2" start="14">    ],</span>
<span class="line width-2" start="15">    <span class="hljs-comment">// 当请求路径不在缓存里的返回，对于单页应用来说，入口点是一样的</span></span>
<span class="line width-2" start="16">    navigateFallback: <span class="hljs-string">'/index.html'</span>,</span>
<span class="line width-2" start="17">    <span class="hljs-comment">// 白名单包含所有的.html (for HTML imports) 和路径中含 `/data/`</span></span>
<span class="line width-2" start="18">    navigateFallbackWhitelist: [<span class="hljs-regexp">/^(?!.*\.html$|\/data\/).*/</span>],</span>
<span class="line width-2" start="19"></span>
<span class="line width-2" start="20">    <span class="hljs-comment">// 最大缓存大小</span></span>
<span class="line width-2" start="21">    maximumFileSizeToCacheInBytes: <span class="hljs-number">4194304</span>,</span>
<span class="line width-2" start="22">}</span>
</code></pre>
</article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:76.39000745712156px;top:-5.704697986577182px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500193128529" class="at-block-content"><h1><span style="font-size:48px">用<span style="color:#0062B1"><em>Lavas</em></span> 开发</span></h1></article></div><div style="left:73.8220064724919px;top:81.84466019417476px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500193133513" class="at-block-content"><ul><li><span style="font-size:24px">自定义配置</span></li></ul></article></div><div style="left:90.79008820356621px;top:138.38587473824478px;width:800px;height:340.332508407894px;" class="at-block at-block--pure"><article data-block-id="1500193138671" class="at-block-content MarkdownBlock"><pre class="hljs"><code class="lang-js"><span class="line width-2" start="1"><span class="hljs-comment">/* sw-precache.js中的配置 */</span></span>
<span class="line width-2" start="2">build: {</span>
<span class="line width-2" start="3">    <span class="hljs-comment">// 生成service-worker.js的文件配置模板，不配置时采用默认的配置</span></span>
<span class="line width-2" start="4">    <span class="hljs-comment">// 本demo做了sw的更新策略，所以在原有模板基础做了相应的修改</span></span>
<span class="line width-2" start="5">    templateFilePath: <span class="hljs-string">'config/sw.tmpl.js'</span>,</span>
<span class="line width-2" start="6"></span>
<span class="line width-2" start="7">    <span class="hljs-comment">// 需要根据路由动态处理的文件</span></span>
<span class="line width-2" start="8">    runtimeCaching: [</span>
<span class="line width-2" start="9">    ]</span>
<span class="line width-2" start="10">}</span>
<span class="line width-2" start="11"><span class="hljs-comment">// webpack.prod.conf.js 中通过组件引入配置，生成文件</span></span>
<span class="line width-2" start="12"><span class="hljs-keyword">new</span> SWPrecacheWebpackPlugin(config.swPrecache.build);</span>
</code></pre>
</article></div><div style="left:76.38562091503267px;top:474.9019607843137px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500196716374" class="at-block-content"><ul><li><span style="font-size:24px">通知更新</span></li></ul></article></div><div style="left:94.68627450980392px;top:532.2222222222222px;width:800px;height:85.62091503267976px;" class="at-block at-block--pure"><article data-block-id="1500196747215" class="at-block-content MarkdownBlock"><pre class="hljs"><code><span class="line width-1" start="1">config/sw<span class="hljs-selector-class">.tmpl</span><span class="hljs-selector-class">.js</span></span>
</code></pre>
</article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:76.39000745712156px;top:-5.704697986577182px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500182646536" class="at-block-content"><h1><span style="font-size:48px">用<span style="color:#0062B1"><em>Lavas</em></span> 开发</span></h1></article></div><div style="left:59px;top:137px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500182795828" class="at-block-content"><ul><li style="text-align:left"><span style="font-size:24px">自动生成App-Shell 模板组件结构</span></li></ul></article></div><div style="left:64px;top:198px;width:444px;height:216.50485436893206px;" class="at-block at-block--pure"><article data-block-id="1500182857060" class="at-block-content MarkdownBlock"><pre class="hljs"><code><span class="line width-1" start="1">src/components</span>
<span class="line width-1" start="2">    ├── AppBottomNavigator<span class="hljs-selector-class">.vue</span></span>
<span class="line width-1" start="3">    ├── AppHeader<span class="hljs-selector-class">.vue</span></span>
<span class="line width-1" start="4">    ├── AppMask<span class="hljs-selector-class">.vue</span></span>
<span class="line width-1" start="5">    ├── AppSidebar<span class="hljs-selector-class">.vue</span></span>
<span class="line width-1" start="6">    ├── ProgressBar<span class="hljs-selector-class">.vue</span></span>
<span class="line width-1" start="7">    └── Sidebar.vue</span>
</code></pre>
</article></div><div style="left:54.40453074433657px;top:436.18122977346275px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500189994860" class="at-block-content"><ul><li><span style="font-size:26px">管理组件状态</span></li></ul></article></div><div style="left:66.05501618122977px;top:494.4660194174757px;width:800px;height:153.07443365695798px;" class="at-block at-block--pure"><article data-block-id="1500190035053" class="at-block-content MarkdownBlock"><pre class="hljs"><code><span class="line width-1" start="1"><span class="hljs-regexp">/src/</span>store<span class="hljs-regexp">/modules/</span>app-shell.js</span>
</code></pre>
</article></div><div style="left:54.04854368932039px;top:560.0970873786407px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500190223553" class="at-block-content"><ul><li><span style="font-size:26px">Vuex</span></li></ul></article></div><div style="left:60.87702265372169px;top:617.443365695793px;width:800px;height:79.28802588996766px;" class="at-block at-block--pure"><article data-block-id="1500190252486" class="at-block-content MarkdownBlock"><pre class="hljs"><code><span class="line width-1" start="1">mapStates() mapActions() - <span class="hljs-keyword">state</span>, actions, mutations</span>
</code></pre>
</article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:79px;top:100px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500192969645" class="at-block-content"><h1><span style="font-size:72px">More <span style="color:#0062B1"><em>Lavas&nbsp;</em></span>Features</span></h1></article></div><div style="left:92.0718954248366px;top:274.9019607843137px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500197130355" class="at-block-content"><ul><li><h2><span style="font-size:24px">Vuetify 组件库&nbsp;- Material Design &amp; Vue</span></h2></li><li><span style="font-size:24px">Lavas Server Side Rendering - SSR 模板</span></li></ul></article></div><div style="left:-58.25490196078431px;top:473.2875816993464px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500197144497" class="at-block-content"><p><a href="https://lavas.baidu.com/guide">https://lavas.baidu.com/guide</a></p></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:80px;top:260px;width:800px;" class="at-block at-block--pure"><article data-block-id="1500197203065" class="at-block-content"><h1>THANKS.</h1></article></div></section><style>.at-block{ position:absolute }</style></div></div></div>

    <!-- dependencies -->
		<script src="https://yanshuo.io/assets/player/lib/js/head.min.js"></script>
		<script src="https://yanshuo.io/assets/player/js/reveal.min.js"></script>

    <!-- init -->
    <script>
      Reveal.initialize({
        controls: true,
        history: true,
        center: false,

        transition:             'slide',
        backgroundTransition:   'slide',
        transitionSpeed:        'default',

        // no marked.js
				// no markdown.js
				// no highlight.js
				dependencies: [
					{ src: 'https://yanshuo.io/assets/player/lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'https://yanshuo.io/assets/player/plugin/zoom-js/zoom.js', async: true },
					{ src: 'https://yanshuo.io/assets/player/plugin/notes/notes.js', async: true }
				]
      });
    </script>
  </body>
</html>
